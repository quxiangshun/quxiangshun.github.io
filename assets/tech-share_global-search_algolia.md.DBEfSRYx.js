import{_ as o,C as l,o as r,c as n,ag as i,E as e,w as h}from"./chunks/framework.DEqXEGcv.js";const _=JSON.parse('{"title":"Algolia 集成","description":"项目集成 Algolia 文档搜索的详细说明","frontmatter":{"title":"Algolia 集成","description":"项目集成 Algolia 文档搜索的详细说明"},"headers":[],"relativePath":"tech-share/global-search/algolia.md","filePath":"tech-share/global-search/algolia.md"}'),d={name:"tech-share/global-search/algolia.md"};function c(p,a,g,k,u,E){const s=l("AlgoliaGenerator"),t=l("ClientOnly");return r(),n("div",null,[a[0]||(a[0]=i(`<h1 id="algolia-集成" tabindex="-1">Algolia 集成 <a class="header-anchor" href="#algolia-集成" aria-label="Permalink to &quot;Algolia 集成&quot;">​</a></h1><p>本文档说明如何在 Ly Docs 项目中集成 Algolia 文档搜索（<a href="/tech-share/global-search/">全局搜索方案二</a>）。</p><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h2><p>Algolia DocSearch 为文档站点提供全文搜索能力。本项目通过以下方式生成索引数据：</p><ol><li><strong>命令行生成</strong>：Node.js 脚本批量解析 Markdown，输出 JSON</li><li><strong>页面生成</strong>：在浏览器中运行，生成后直接下载 JSON 文件</li></ol><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><p>搜索配置位于 <code>.vitepress/config.mts</code>：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  provider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;algolia&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    appId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YOUR_APP_ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    apiKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YOUR_SEARCH_API_KEY&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    indexName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;YOUR_INDEX_NAME&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><strong>appId</strong>：Algolia 应用 ID（<a href="https://www.algolia.com" target="_blank" rel="noreferrer">algolia.com</a> 控制台）</li><li><strong>apiKey</strong>：Search-Only API Key（仅用于前端搜索，可公开）</li><li><strong>indexName</strong>：索引名称</li></ul><h2 id="生成-json-记录" tabindex="-1">生成 JSON 记录 <a class="header-anchor" href="#生成-json-记录" aria-label="Permalink to &quot;生成 JSON 记录&quot;">​</a></h2><h3 id="方式一-命令行生成" tabindex="-1">方式一：命令行生成 <a class="header-anchor" href="#方式一-命令行生成" aria-label="Permalink to &quot;方式一：命令行生成&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tech-share/global-search</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate.js</span></span></code></pre></div><p>输出：<code>tech-share/global-search/algolia-records.json</code></p><h3 id="方式二-页面生成-推荐" tabindex="-1">方式二：页面生成（推荐） <a class="header-anchor" href="#方式二-页面生成-推荐" aria-label="Permalink to &quot;方式二：页面生成（推荐）&quot;">​</a></h3><ol><li>启动文档站点：<code>npm run docs:dev</code></li><li>打开本页面</li><li>点击 <strong>「生成并下载 JSON」</strong> 按钮</li><li>浏览器将下载 <code>algolia-records.json</code> 文件</li></ol>`,15)),e(t,null,{default:h(()=>[e(s)]),_:1}),a[1]||(a[1]=i('<h2 id="上传到-algolia" tabindex="-1">上传到 Algolia <a class="header-anchor" href="#上传到-algolia" aria-label="Permalink to &quot;上传到 Algolia&quot;">​</a></h2><ol><li>登录 <a href="https://dashboard.algolia.com/" target="_blank" rel="noreferrer">Algolia Dashboard</a></li><li>选择应用 → 选择索引（或新建）</li><li>进入 <strong>Upload records</strong></li><li>上传生成的 <code>algolia-records.json</code></li><li>上传会<strong>追加</strong>记录；如需全量替换，请先清空索引再上传</li></ol><h2 id="记录格式" tabindex="-1">记录格式 <a class="header-anchor" href="#记录格式" aria-label="Permalink to &quot;记录格式&quot;">​</a></h2><p>每条记录包含（符合 DocSearch 格式）：</p><table tabindex="0"><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>objectID</td><td>唯一标识（必需）</td></tr><tr><td>url</td><td>文档 URL 路径</td></tr><tr><td>hierarchy</td><td>标题层级对象 <code>{ lvl0, lvl1, lvl2, lvl3, lvl4, lvl5 }</code></td></tr><tr><td>content</td><td>正文内容（用于搜索）</td></tr></tbody></table><h2 id="索引配置-重要" tabindex="-1">索引配置（重要） <a class="header-anchor" href="#索引配置-重要" aria-label="Permalink to &quot;索引配置（重要）&quot;">​</a></h2><p>首次上传后，需在 Algolia Dashboard 配置索引以支持 DocSearch：</p><ol><li>进入 <strong>Search</strong> → <strong>Index</strong> → 选择 <code>ly-docs</code></li><li>打开 <strong>Configuration</strong> → <strong>Searchable attributes</strong></li><li>添加并排序（按优先级从高到低）： <ul><li><code>unordered(hierarchy.lvl0)</code></li><li><code>unordered(hierarchy.lvl1)</code></li><li><code>unordered(hierarchy.lvl2)</code></li><li><code>unordered(hierarchy.lvl3)</code></li><li><code>unordered(hierarchy.lvl4)</code></li><li><code>unordered(hierarchy.lvl5)</code></li><li><code>content</code></li></ul></li><li>保存配置</li></ol><p>若搜索仍无结果，检查 <strong>Configuration</strong> → <strong>Facets</strong> 中是否误将 <code>hierarchy</code> 设为 facet（应移除）。</p><h2 id="排除目录" tabindex="-1">排除目录 <a class="header-anchor" href="#排除目录" aria-label="Permalink to &quot;排除目录&quot;">​</a></h2><p>以下目录的 Markdown 不会纳入索引：</p><ul><li><code>node_modules</code></li><li><code>.git</code></li><li><code>.vitepress</code></li><li><code>dist</code></li><li><code>public</code></li></ul><h2 id="相关链接" tabindex="-1">相关链接 <a class="header-anchor" href="#相关链接" aria-label="Permalink to &quot;相关链接&quot;">​</a></h2><ul><li><a href="https://www.algolia.com/doc/" target="_blank" rel="noreferrer">Algolia 文档</a></li><li><a href="https://docsearch.algolia.com/" target="_blank" rel="noreferrer">DocSearch 说明</a></li><li><a href="https://vitepress.dev/reference/default-theme-search" target="_blank" rel="noreferrer">VitePress 搜索配置</a></li></ul>',14))])}const y=o(d,[["render",c]]);export{_ as __pageData,y as default};
