import{_ as a,o as i,c as n,a2 as e}from"./chunks/framework.C766EroN.js";const c=JSON.parse('{"title":"LyEdu 后端开发指南","description":"","frontmatter":{},"headers":[],"relativePath":"projects/lyedu/backend-dev.md","filePath":"projects/lyedu/backend-dev.md"}'),l={name:"projects/lyedu/backend-dev.md"};function t(p,s,h,r,d,k){return i(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="lyedu-后端开发指南" tabindex="-1">LyEdu 后端开发指南 <a class="header-anchor" href="#lyedu-后端开发指南" aria-label="Permalink to &quot;LyEdu 后端开发指南&quot;">​</a></h1><blockquote><p>编辑日期：2026-02-26<br> 基于 <a href="https://gitee.com/quxiangshun/ly-edu" target="_blank" rel="noreferrer">ly-edu</a> 项目结构整理</p></blockquote><h2 id="一、后端项目概览" tabindex="-1">一、后端项目概览 <a class="header-anchor" href="#一、后端项目概览" aria-label="Permalink to &quot;一、后端项目概览&quot;">​</a></h2><p>LyEdu 提供<strong>双后端</strong>架构，可按团队技术栈任选其一或对照使用：</p><table tabindex="0"><thead><tr><th>实现</th><th>目录</th><th>技术栈</th><th>端口</th><th>说明</th></tr></thead><tbody><tr><td>Java</td><td>lyedu-api</td><td>Spring Boot 4、JDK 25、MyBatis Plus、MySQL、Flyway</td><td>8080</td><td>传统 Java 技术栈</td></tr><tr><td>Python</td><td>lyedu-api-python</td><td>FastAPI、SQLAlchemy、MySQL、Alembic</td><td>9700</td><td>推荐，更新更活跃</td></tr></tbody></table><p>接口设计保持一致，数据库共用 <code>db/</code> 下的迁移脚本。</p><h2 id="二、开发环境准备" tabindex="-1">二、开发环境准备 <a class="header-anchor" href="#二、开发环境准备" aria-label="Permalink to &quot;二、开发环境准备&quot;">​</a></h2><h3 id="公共依赖" tabindex="-1">公共依赖 <a class="header-anchor" href="#公共依赖" aria-label="Permalink to &quot;公共依赖&quot;">​</a></h3><ul><li><strong>MySQL</strong>：8.0+</li><li><strong>Redis</strong>：可选，用于会话/缓存</li><li><strong>Docker &amp; Docker Compose</strong>：可选，快速启动 MySQL + Redis</li></ul><h3 id="启动-mysql-redis-docker" tabindex="-1">启动 MySQL + Redis（Docker） <a class="header-anchor" href="#启动-mysql-redis-docker" aria-label="Permalink to &quot;启动 MySQL + Redis（Docker）&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scripts/docker/compose-mysql-redis.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><p>若使用自有 MySQL/Redis，可跳过此步，直接在配置中填写连接信息。</p><h2 id="三、python-后端-推荐" tabindex="-1">三、Python 后端（推荐） <a class="header-anchor" href="#三、python-后端-推荐" aria-label="Permalink to &quot;三、Python 后端（推荐）&quot;">​</a></h2><h3 id="环境要求" tabindex="-1">环境要求 <a class="header-anchor" href="#环境要求" aria-label="Permalink to &quot;环境要求&quot;">​</a></h3><ul><li>Python 3.10+</li><li>虚拟环境（venv）</li></ul><h3 id="启动步骤" tabindex="-1">启动步骤 <a class="header-anchor" href="#启动步骤" aria-label="Permalink to &quot;启动步骤&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lyedu-api-python</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .venv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活（Windows）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.venv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">activate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活（Linux / Mac）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># source .venv/bin/activate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制环境变量</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.dev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 或 .env</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改 .env.dev 中的 database / redis 等配置</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 数据库迁移（首次或 schema 变更后）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alembic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alembic.ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> head</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动服务</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dev</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uvicorn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main:app</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reload</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0.0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9700</span></span></code></pre></div><ul><li><strong>API 文档</strong>：<a href="http://localhost:9700/api-docs" target="_blank" rel="noreferrer">http://localhost:9700/api-docs</a></li><li><strong>数据库配置</strong>：<code>database.url</code> 等，见 <code>configuration.md</code></li></ul><h3 id="一键启动" tabindex="-1">一键启动 <a class="header-anchor" href="#一键启动" aria-label="Permalink to &quot;一键启动&quot;">​</a></h3><p>使用项目脚本（会先迁移再启动）：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.\\scripts\\dev\\start.ps1</span></span></code></pre></div><p>在 <code>scripts/dev/dev-config.yml</code> 中配置 <code>start_lyedu_api_python: true</code> 及数据库连接。</p><h2 id="四、java-后端" tabindex="-1">四、Java 后端 <a class="header-anchor" href="#四、java-后端" aria-label="Permalink to &quot;四、Java 后端&quot;">​</a></h2><h3 id="环境要求-1" tabindex="-1">环境要求 <a class="header-anchor" href="#环境要求-1" aria-label="Permalink to &quot;环境要求&quot;">​</a></h3><ul><li>JDK 25</li><li>Gradle（项目含 Wrapper）</li></ul><h3 id="构建与启动" tabindex="-1">构建与启动 <a class="header-anchor" href="#构建与启动" aria-label="Permalink to &quot;构建与启动&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lyedu-api</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化 Gradle Wrapper（首次）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">init-gradle.ps1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # Windows</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或手动: gradle wrapper</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建 jar</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">build-api.ps1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # Windows</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或 ./build-api.sh # Linux / Mac</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或 ./gradlew bootJar</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># jar 输出到 pkg/lyedu-api.jar</span></span></code></pre></div><p>启动方式：</p><ul><li><strong>IDE</strong>：运行 <code>Application</code> 主类，<code>--spring.profiles.active=dev</code></li><li><strong>命令行</strong>：<code>java -jar pkg/lyedu-api.jar --spring.profiles.active=dev</code></li><li><strong>Docker</strong>：见 <code>deployment.md</code></li></ul><p>数据库配置在 <code>application.yml</code> 中。</p><h2 id="五、数据库与迁移" tabindex="-1">五、数据库与迁移 <a class="header-anchor" href="#五、数据库与迁移" aria-label="Permalink to &quot;五、数据库与迁移&quot;">​</a></h2><h3 id="统一迁移目录" tabindex="-1">统一迁移目录 <a class="header-anchor" href="#统一迁移目录" aria-label="Permalink to &quot;统一迁移目录&quot;">​</a></h3><ul><li><strong>Java / Flyway</strong>：<code>db/flyway/</code></li><li><strong>Python / Alembic</strong>：<code>db/alembic/</code></li></ul><p>详细说明见 <a href="https://gitee.com/quxiangshun/ly-edu/blob/main/db/README.md" target="_blank" rel="noreferrer">db/README.md</a>。</p><h3 id="python-迁移命令" tabindex="-1">Python 迁移命令 <a class="header-anchor" href="#python-迁移命令" aria-label="Permalink to &quot;Python 迁移命令&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lyedu-api-python</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 升级到最新</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alembic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alembic.ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> head</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生成迁移</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alembic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alembic.ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> revision</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --autogenerate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;描述&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 回滚</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alembic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alembic.ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> downgrade</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1</span></span></code></pre></div><h3 id="java-迁移" tabindex="-1">Java 迁移 <a class="header-anchor" href="#java-迁移" aria-label="Permalink to &quot;Java 迁移&quot;">​</a></h3><p>Flyway 随应用启动自动执行，只需保证 <code>db/flyway/</code> 下脚本符合规范。</p><h2 id="六、项目结构-python-示例" tabindex="-1">六、项目结构（Python 示例） <a class="header-anchor" href="#六、项目结构-python-示例" aria-label="Permalink to &quot;六、项目结构（Python 示例）&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>lyedu-api-python/</span></span>
<span class="line"><span>├── main.py           # FastAPI 入口</span></span>
<span class="line"><span>├── alembic.ini       # Alembic 配置</span></span>
<span class="line"><span>├── requirements.txt</span></span>
<span class="line"><span>├── .env.example</span></span>
<span class="line"><span>├── app/</span></span>
<span class="line"><span>│   ├── api/          # 路由</span></span>
<span class="line"><span>│   ├── core/         # 配置、安全</span></span>
<span class="line"><span>│   ├── models/       # ORM 模型</span></span>
<span class="line"><span>│   ├── schemas/      # Pydantic 模型</span></span>
<span class="line"><span>│   └── services/     # 业务逻辑</span></span>
<span class="line"><span>└── alembic/</span></span>
<span class="line"><span>    └── versions/</span></span></code></pre></div><h2 id="七、认证与授权" tabindex="-1">七、认证与授权 <a class="header-anchor" href="#七、认证与授权" aria-label="Permalink to &quot;七、认证与授权&quot;">​</a></h2><ul><li><strong>JWT</strong>：登录后返回 token，请求头 <code>Authorization: Bearer &lt;token&gt;</code></li><li><strong>飞书登录</strong>：OAuth2 流程，回调后生成 JWT</li><li><strong>权限</strong>：基于角色（RBAC），接口有权限注解/依赖</li></ul><h2 id="八、开发建议" tabindex="-1">八、开发建议 <a class="header-anchor" href="#八、开发建议" aria-label="Permalink to &quot;八、开发建议&quot;">​</a></h2><ol><li><strong>环境变量</strong>：敏感信息放 <code>.env</code>，勿提交仓库</li><li><strong>迁移</strong>：改表结构先写迁移，再改代码</li><li><strong>接口</strong>：与前端约定路径、请求/响应格式，可参考 Swagger</li><li><strong>日志</strong>：统一使用 logging，区分 dev/prod 级别</li></ol><h2 id="相关链接" tabindex="-1">相关链接 <a class="header-anchor" href="#相关链接" aria-label="Permalink to &quot;相关链接&quot;">​</a></h2><ul><li><a href="/projects/lyedu/frontend-dev.html">前端开发指南</a></li><li><a href="/projects/lyedu/api-docs.html">API 文档</a></li><li><a href="/projects/lyedu/configuration.html">配置参考</a></li><li><a href="/projects/lyedu/deployment.html">部署指南</a></li><li><a href="https://gitee.com/quxiangshun/ly-edu" target="_blank" rel="noreferrer">项目仓库</a></li></ul>`,46)])])}const g=a(l,[["render",t]]);export{c as __pageData,g as default};
