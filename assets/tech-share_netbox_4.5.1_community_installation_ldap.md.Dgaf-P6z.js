import{_ as i,o as a,c as t,ag as n}from"./chunks/framework.DEqXEGcv.js";const c=JSON.parse('{"title":"LDAP 认证","description":"NetBox LDAP 配置","frontmatter":{"title":"LDAP 认证","description":"NetBox LDAP 配置"},"headers":[],"relativePath":"tech-share/netbox/4.5.1/community/installation/ldap.md","filePath":"tech-share/netbox/4.5.1/community/installation/ldap.md"}'),e={name:"tech-share/netbox/4.5.1/community/installation/ldap.md"};function l(h,s,p,k,r,o){return a(),t("div",null,[...s[0]||(s[0]=[n(`<h1 id="ldap-configuration-ldap-配置" tabindex="-1">LDAP Configuration / LDAP 配置 <a class="header-anchor" href="#ldap-configuration-ldap-配置" aria-label="Permalink to &quot;LDAP Configuration / LDAP 配置&quot;">​</a></h1><p><em>内容来源 / Source: <a href="https://netboxlabs.com/docs/netbox/installation/ldap/" target="_blank" rel="noreferrer">NetBox Labs Documentation</a> | 如有侵权请<a href="/contact.html">联系我们</a>删除</em></p><p>This guide explains how to implement LDAP authentication using an external server. User authentication will fall back to built-in Django users on failure.</p><p>本指南说明如何使用外部服务器实现 LDAP 认证。认证失败时将回退到内置 Django 用户。</p><h2 id="install-requirements-安装依赖" tabindex="-1">Install Requirements / 安装依赖 <a class="header-anchor" href="#install-requirements-安装依赖" aria-label="Permalink to &quot;Install Requirements / 安装依赖&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libldap2-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libsasl2-dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libssl-dev</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/netbox/venv/bin/activate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> django-auth-ldap</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;echo &#39;django-auth-ldap&#39; &gt;&gt; /opt/netbox/local_requirements.txt&quot;</span></span></code></pre></div><h2 id="configuration-配置" tabindex="-1">Configuration / 配置 <a class="header-anchor" href="#configuration-配置" aria-label="Permalink to &quot;Configuration / 配置&quot;">​</a></h2><p>In <code>configuration.py</code>:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">REMOTE_AUTH_BACKEND</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;netbox.authentication.LDAPBackend&#39;</span></span></code></pre></div><p>Create <code>ldap_config.py</code> in the same directory as <code>configuration.py</code> (typically <code>/opt/netbox/netbox/netbox/</code>). Define parameters per <a href="https://django-auth-ldap.readthedocs.io/" target="_blank" rel="noreferrer">django-auth-ldap documentation</a>.</p><h3 id="general-server-config-通用服务器配置" tabindex="-1">General Server Config / 通用服务器配置 <a class="header-anchor" href="#general-server-config-通用服务器配置" aria-label="Permalink to &quot;General Server Config / 通用服务器配置&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ldap</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_SERVER_URI</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ldaps://ad.example.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_CONNECTION_OPTIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ldap.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPT_REFERRALS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_BIND_DN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CN=NETBOXSA, OU=Service Accounts,DC=example,DC=com&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_BIND_PASSWORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;your_password&quot;</span></span></code></pre></div><h3 id="user-authentication-用户认证" tabindex="-1">User Authentication / 用户认证 <a class="header-anchor" href="#user-authentication-用户认证" aria-label="Permalink to &quot;User Authentication / 用户认证&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> django_auth_ldap.config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LDAPSearch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_USER_SEARCH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LDAPSearch(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ou=Users,dc=example,dc=com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ldap.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SCOPE_SUBTREE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;(sAMAccountName=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%(user)s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_USER_DN_TEMPLATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;uid=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%(user)s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,ou=users,dc=example,dc=com&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AUTH_LDAP_USER_ATTR_MAP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;first_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;givenName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;last_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mail&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="active-directory-active-directory" tabindex="-1">Active Directory / Active Directory <a class="header-anchor" href="#active-directory-active-directory" aria-label="Permalink to &quot;Active Directory / Active Directory&quot;">​</a></h3><p>When using Windows Server 2012+, set <code>AUTH_LDAP_USER_DN_TEMPLATE = None</code>. Use <code>NestedGroupOfNamesType()</code> for nested groups.</p><h2 id="restart-重启" tabindex="-1">Restart / 重启 <a class="header-anchor" href="#restart-重启" aria-label="Permalink to &quot;Restart / 重启&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netbox</span></span></code></pre></div>`,18)])])}const g=i(e,[["render",l]]);export{c as __pageData,g as default};
