var c=(a,h,r)=>new Promise((g,t)=>{var i=s=>{try{d(r.next(s))}catch(p){t(p)}},$=s=>{try{d(r.throw(s))}catch(p){t(p)}},d=s=>s.done?g(s.value):Promise.resolve(s.value).then(i,$);d((r=r.apply(a,h)).next())});import{_ as B}from"./form.vue_vue_type_script_setup_true_lang-qSyCF7x_.js";import{aP as u,aX as f,n as m,P as b,q as E,a2 as T,R as z,e as F,h as H,S as U,T as L,U as O}from"./index-B7W7rs76.js";import{s as X}from"./index-B9geSWXR.js";import"./hooks-D07EST8v.js";const l="/sysConfig",j=a=>u.request("post",f(`${l}/create`),{data:a}),G=a=>u.request("get",f(`${l}/list`),{params:a}),J=a=>u.request("get",f(`${l}/get/${a}`)),Q=a=>u.request("put",f(`${l}/update`),{data:a}),W=a=>u.request("delete",f(`${l}/delete/${a}`)),Y=()=>u.request("get",f(`${l}/refreshCache`));function ae(){const a=m(""),h=m(),r=m([]),g=m(!0),t=b({total:0,pageSize:12,currentPage:1,background:!0}),i=b({configName:"",size:t.pageSize,current:t.currentPage});function $(e){X("警告",{contentRenderer:()=>F("p",{style:"text-align: center;margin-bottom:20px"},[H("确认要将该配置："),F("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.configName]),H("删除吗?")]),beforeSure:n=>c(this,null,function*(){(yield W(e.id)).code=="H200"&&z(`已将"${e.configName}删除`,{type:"success"}),n(),o()})})}function d(e){return c(this,null,function*(){N("修改",e)})}function s(e){t.currentPage=1,t.pageSize=e,o()}function p(e){t.currentPage=e,o()}function x(e){}function o(){return c(this,null,function*(){g.value=!0,i.current=t.currentPage,i.size=t.pageSize;const{data:e,code:n}=yield G(T(i));n=="H200"&&(r.value=e.records,t.total=e.total,t.pageSize=e.size,t.currentPage=e.current),g.value=!1})}const k=e=>{e&&(e.resetFields(),o())};function N(e="新增",n){var P,R,q,D,I;let y=m({});U({title:`${e}配置`,props:{formInline:{id:(P=n==null?void 0:n.id)!=null?P:null,configName:(R=n==null?void 0:n.configName)!=null?R:"",configKey:(q=n==null?void 0:n.configKey)!=null?q:"",configValue:(D=n==null?void 0:n.configValue)!=null?D:"",remark:(I=n==null?void 0:n.remark)!=null?I:""}},width:"45%",top:"5vh",draggable:!0,fullscreen:O(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>L(B,{ref:h}),open:A=>c(this,[A],function*({options:C}){if(e!=="新增"){const v=yield J(n.id);v.code=="H200"&&(y.value=v.data),C.props.formInline.configKey=y.value.configKey,C.props.formInline.configValue=y.value.configValue}}),beforeSure:(C,{options:A})=>{const v=h.value.getRef(),S=A.props.formInline;function V(){z(`您${e}了配置名称为${S.configName}的这条数据`,{type:"success"}),C(),o()}v.validate(M=>c(this,null,function*(){M&&(e==="新增"?(yield j(S)).code=="H200"&&V():(yield Q(S)).code=="H200"&&V())}))}})}function K(){return c(this,null,function*(){(yield Y()).code=="H200"&&z("缓存刷新成功",{type:"success"})})}return E(()=>c(this,null,function*(){o()})),{form:i,loading:g,pagination:t,searchValue:a,dataList:r,onSearch:o,resetForm:k,openDialog:N,handleManageItem:d,handleDeleteItem:$,handleSizeChange:s,handleCurrentChange:p,handleSelectionChange:x,handleRefreshCache:K}}export{ae as useConfig};
