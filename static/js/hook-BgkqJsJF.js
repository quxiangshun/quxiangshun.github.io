var f=(a,c,d)=>new Promise((g,i)=>{var p=s=>{try{u(d.next(s))}catch(l){i(l)}},R=s=>{try{u(d.throw(s))}catch(l){i(l)}},u=s=>s.done?g(s.value):Promise.resolve(s.value).then(p,R);u((d=d.apply(a,c)).next())});import{aP as D,aX as y,P as F,n as r,e as m,$ as w,R as h,h as b,S as ee,T as te,U as ae,a2 as ne,r as M,bk as se}from"./index-B7W7rs76.js";import{_ as le}from"./form.vue_vue_type_script_setup_true_lang-BCLOBaTf.js";import{s as O}from"./index-B9geSWXR.js";import"./enums-3OZQtwCq.js";import"./hooks-D07EST8v.js";const S="/sysDictData",re=a=>D.request("post",y(`${S}/create`),{data:a}),ce=a=>D.request("get",y(`${S}/list`),{params:a}),B=a=>D.request("put",y(`${S}/update`),{data:a}),q=a=>D.request("delete",y(`${S}/delete`),{data:a});function me(){const a=F({total:0,pageSize:10,currentPage:1,background:!0}),c=F({dictId:null,name:"",value:"",status:"",size:a.pageSize,current:a.currentPage}),d=r(),g=r(),i=r(),p=r([]),R=r(!1),u=r(!0),s=r(!1),l=r({}),x=r(0),A=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"数据项名称",prop:"name",width:200,fixed:"left"},{label:"数据项值",prop:"value",width:100,fixed:"left"},{label:"状态",cellRenderer:e=>{var t;return m(M("el-switch"),{size:e.props.size==="small"?"small":"default",loading:(t=l.value[e.index])==null?void 0:t.loading,modelValue:e.row.status,"onUpdate:modelValue":n=>e.row.status=n,"active-value":0,"inactive-value":1,"active-text":"已启用","inactive-text":"已停用",style:"--el-switch-on-color: #13ce66","inline-prompt":!0,onChange:()=>L(e)},null)},minWidth:80},{label:"颜色",prop:"color",cellRenderer:e=>m(M("el-tag"),{color:e.row.color},{default:()=>[e.row.color===""?"无":e.row.color]}),minWidth:80},{label:"创建时间",prop:"createTime",minWidth:100,formatter:({createTime:e})=>w(e).format("YYYY-MM-DD HH:mm:ss")},{label:"备注",prop:"remark",minWidth:160},{label:"操作",fixed:"right",width:150,slot:"operation"}];function L({row:e,index:t}){se.confirm(`确认要<strong>${e.status===1?"停用":"启用"}</strong><strong style='color:var(--el-color-primary)'>${e.name}</strong>吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(()=>f(this,null,function*(){l.value[t]=Object.assign({},l.value[t],{loading:!0}),(yield B(e)).code=="H200"&&(l.value[t]=Object.assign({},l.value[t],{loading:!1}),h(`已${e.status===1?"停用":"启用"}${e.name}`,{type:"success"})),o()})).catch(()=>{e.status===0?e.status=1:e.status=0})}function U(e){O("警告",{contentRenderer:()=>m("p",{style:"text-align: center;margin-bottom:20px"},[b("确认要删除"),m("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.name]),b("吗?")]),beforeSure:t=>f(this,null,function*(){(yield q([e.id])).code=="H200"&&h(`已删除${e.name}`,{type:"success"}),t(),o()})})}function V(e){a.currentPage=1,a.pageSize=e,o()}function W(e){a.currentPage=e,o()}function Y(e){x.value=e.length,i.value.setAdaptive()}function o(){return f(this,null,function*(){u.value=!0,c.current=a.currentPage,c.size=a.pageSize;const{code:e,data:t,message:n}=yield ce(ne(c));e!="H200"?h(n,{type:"error"}):(p.value=t.records,a.total=t.total,a.pageSize=t.size,a.currentPage=t.current),u.value=!1})}const C=e=>{e&&(e.resetFields(),o())};function j(e="新增",t){var n,$,v,H,P,T,I;ee({title:`${e}字典数据项`,props:{formInline:{id:(n=t==null?void 0:t.id)!=null?n:null,dictId:c.dictId,name:($=t==null?void 0:t.name)!=null?$:"",value:(v=t==null?void 0:t.value)!=null?v:"",color:(H=t==null?void 0:t.color)!=null?H:"",status:(P=t==null?void 0:t.status)!=null?P:0,sortOrder:(T=t==null?void 0:t.sortOrder)!=null?T:1,remark:(I=t==null?void 0:t.remark)!=null?I:""}},width:"35%",draggable:!0,fullscreen:ae(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>te(le,{ref:g}),beforeSure:(G,{options:J})=>{const K=g.value.getRef(),z=J.props.formInline;function k(){h(`您${e}了数据项名称为${z.name}的这条数据`,{type:"success"}),G(),o()}K.validate(Q=>f(this,null,function*(){Q&&(e==="新增"?(yield re(z)).code=="H200"&&k():(yield B(z)).code=="H200"&&k())}))}})}function N(e){c.dictId=e.id,a.currentPage=1,a.pageSize=10,C(g.value)}function _(){p.value=[]}function E(){x.value=0,i.value.getTableRef().clearSelection()}function X(){const e=i.value.getTableRef().getSelectionRows();O("警告",{contentRenderer:()=>m("p",{style:"text-align: center;margin-bottom:20px"},[b("确认要删除"),e.map((t,n)=>m("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[t.name,n<e.length-1?"、":""])),b("吗?")]),beforeSure:t=>f(this,null,function*(){const n=e.map(v=>v.id);(yield q(n)).code=="H200"&&h("删除成功",{type:"success"}),t(),i.value.getTableRef().clearSelection(),o()})})}return{form:c,isShow:R,curRow:d,loading:u,columns:A,dataList:p,isLinkage:s,pagination:a,formRef:g,tableRef:i,selectedNum:x,onSearch:o,resetForm:C,openDialog:j,handleDelete:U,handleSizeChange:V,handleCurrentChange:W,handleSelectionChange:Y,handleDrawerOpen:N,handleDrawerClose:_,handleSelectionCancel:E,handlebatchDelete:X}}export{me as useDictData};
