var c=(l,n,o)=>new Promise((s,r)=>{var t=e=>{try{a(o.next(e))}catch(f){r(f)}},i=e=>{try{a(o.throw(e))}catch(f){r(f)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(t,i);a((o=o.apply(l,n)).next())});import{d as y}from"./file-code-fill-xC31VzlZ.js";import{d as h,n as C,r as b,c as k,o as w,e as I,g as v,S as R,T as O,U as S,R as m}from"./index-z501862F.js";import{_ as D}from"./form.vue_vue_type_script_setup_true_lang-CKngE-Z4.js";import{t as F,b as x}from"./category-DlOD2DRX.js";import{t as A}from"./dept-fRbeL0_M.js";import{g as B}from"./task-wBkvISsG.js";const M=h({__name:"addScript",setup(l){const n=C();function o(){return c(this,null,function*(){const{data:s}=yield A(),{data:r}=yield B(),{data:t}=yield F(7);R({title:"上传脚本",props:{formAttrProp:{nameLabel:"脚本",depts:s,tasks:r,categoryOptions:t}},width:"100%",top:"0%",draggable:!0,fullscreen:S(),fullscreenIcon:!0,closeOnClickModal:!1,hideFooter:!0,contentRenderer:()=>O(D,{ref:n}),beforeSure:(e,f)=>c(this,[e,f],function*(i,{options:a}){const u=n.value.getRef(),p=a.props.formInline;function _(){m(`新增${p.title}成功`,{type:"success"}),i()}u.validate(g=>c(this,null,function*(){if(g)try{(yield x(p)).code=="H200"&&_()}catch(d){console.error("Error update menu:",d),m("新增脚本时出错",{type:"error"})}}))})})})}return(s,r)=>{const t=b("IconifyIconOffline");return w(),k("span",{class:"fullscreen-icon navbar-bg-hover",onClick:o},[I(t,{icon:v(y)},null,8,["icon"])])}}});export{M as _};
