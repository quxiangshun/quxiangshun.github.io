var c=(s,f,o)=>new Promise((u,i)=>{var g=n=>{try{p(o.next(n))}catch(l){i(l)}},h=n=>{try{p(o.throw(n))}catch(l){i(l)}},p=n=>n.done?u(n.value):Promise.resolve(n.value).then(g,h);p((o=o.apply(s,f)).next())});import{_ as H}from"./form.vue_vue_type_script_setup_true_lang-Du_TZkeZ.js";import{P as q,n as y,q as I,M,bh as N,e as v,R as d,h as S,S as V,T as z,U as L,r as A,aY as B}from"./index-vTRDVSJy.js";import{t as E,l as P,d as U,a as Y,u as G}from"./task-column-BVM0EFo9.js";import{s as J}from"./index-D8NgSwpL.js";import"./index-CeG7CI6B.js";import"./hooks-gvBetFC1.js";function K(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!B(s)}function ae(){const s=q({name:""}),f=y(),o=y([]),u=y([]),i=y(!0),g=t=>{const e=u.value.filter(a=>a.value===t);return e&&e.length>0?e[0].label:""},h=[{label:"字段名称",prop:"name",align:"left"},{label:"字段名称",prop:"selectOptions"},{label:"排序",prop:"sortOrder",width:100},{label:"显示状态",prop:"visible",cellRenderer:({row:t,props:e})=>{let a;return v(A("el-tag"),{size:e.size,type:"success",effect:"plain"},K(a=g(t.type))?a:{default:()=>[a]})},width:100},{label:"操作",fixed:"right",width:210,slot:"operation"}];function p(t){}function n(t){t&&(t.resetFields(),l())}function l(){return c(this,null,function*(){i.value=!0;const{code:t,data:e}=yield P();let a=e;t!="H200"||(M(s.name)||(a=a.filter(m=>m.name.includes(s.name))),o.value=N(a)),i.value=!1})}function $(t="新增",e){return c(this,null,function*(){var a,m,T,C,O,R;V({title:`${t}任务字段`,props:{formInline:{id:(a=e==null?void 0:e.id)!=null?a:null,types:u,type:(m=e==null?void 0:e.type)!=null?m:1,isRequired:(T=e==null?void 0:e.isRequired)!=null?T:0,name:(C=e==null?void 0:e.name)!=null?C:"",sortOrder:(O=e==null?void 0:e.sortOrder)!=null?O:1,selectOptions:(R=e==null?void 0:e.selectOptions)!=null?R:[]}},width:"55%",top:"2%",draggable:!0,fullscreen:L(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>z(H,{ref:f}),beforeSure:(le,oe)=>c(this,[le,oe],function*(D,{options:F}){const _=f.value.getRef(),b=F.props.formInline;function k(){d(`${t}视频合集：${b.name}成功`,{type:"success"}),D(),l()}_.validate(j=>c(this,null,function*(){if(j)try{if(t==="新增"){const r=yield Y(b);r.code=="H200"?k():d(`${r.message}`,{type:"error"})}else{const r=yield G(b);r.code=="H200"?k():d(`${r.message}`,{type:"error"})}}catch(r){console.error("Error update menu:",r),d(`${t}视频合集时出错`,{type:"error"})}}))})})})}function x(t){J("警告",{contentRenderer:()=>v("p",{style:"text-align: center;margin-bottom:20px"},[S("确认要删除"),v("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[t.name]),S("吗？")]),beforeSure:e=>c(this,null,function*(){(yield U(t.id)).code=="H200"&&d(`已删除"${t.name}`,{type:"success"}),e(),l()})})}return I(()=>c(this,null,function*(){const{data:t}=yield E();u.value=t,l()})),{form:s,loading:i,columns:h,dataList:o,onSearch:l,resetForm:n,openDialog:$,handleDelete:x,handleSelectionChange:p}}export{ae as useTaskColumn};
