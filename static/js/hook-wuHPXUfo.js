var c=(n,h,u)=>new Promise((g,a)=>{var o=s=>{try{d(u.next(s))}catch(p){a(p)}},F=s=>{try{d(u.throw(s))}catch(p){a(p)}},d=s=>s.done?g(s.value):Promise.resolve(s.value).then(o,F);d((u=u.apply(n,h)).next())});import{_ as U}from"./form.vue_vue_type_script_setup_true_lang-71j0pudI.js";import{aP as i,aX as l,n as m,P as H,q as K,a2 as L,e as S,R as E,h as $,S as O,T as X,U as j}from"./index-z501862F.js";import{s as I}from"./index-C27yIgHt.js";import"./hooks-BuEsGYNv.js";const f="/sysFileConfig",G=n=>i.request("post",l(`${f}/create`),{data:n}),J=n=>i.request("get",l(`${f}/list`),{params:n}),Q=n=>i.request("get",l(`${f}/get/${n}`)),W=n=>i.request("put",l(`${f}/update`),{data:n}),Y=n=>i.request("put",l(`${f}/updateMaster/${n}`)),Z=n=>i.request("delete",l(`${f}/delete/${n}`));function se(){const n=m(""),h=m(),u=m([]),g=m(!0),a=H({total:0,pageSize:12,currentPage:1,background:!0}),o=H({name:"",size:a.pageSize,current:a.currentPage});function F(e){I("警告",{contentRenderer:()=>S("p",{style:"text-align: center;margin-bottom:20px"},[$("确认要将该配置："),S("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.name]),$("删除吗?")]),beforeSure:t=>c(this,null,function*(){(yield Z(e.id)).code=="H200"&&E(`已将"${e.name}删除`,{type:"success"}),t(),r()})})}function d(e){return c(this,null,function*(){z("修改",e)})}function s(e){I("提示",{contentRenderer:()=>S("p",{style:"text-align: center;margin-bottom:20px"},[$("确认要设置该配置："),S("strong",{style:"color:var(--el-color-warning);margin:0 5px"},[e.name]),$("为主配置吗?")]),beforeSure:t=>c(this,null,function*(){(yield Y(e.id)).code=="H200"&&E(`已将"${e.name}设为主配置`,{type:"success"}),t(),r()})})}function p(e){a.currentPage=1,a.pageSize=e,r()}function M(e){a.currentPage=e,r()}function k(e){}function r(){return c(this,null,function*(){g.value=!0,o.current=a.currentPage,o.size=a.pageSize;const{data:e,code:t}=yield J(L(o));t=="H200"&&(u.value=e.records,a.total=e.total,a.pageSize=e.size,a.currentPage=e.current),g.value=!1})}const V=e=>{e&&(e.resetFields(),r())};function z(e="新增",t){var D,P,x,R,q,B;const y=m({});O({title:`${e}配置`,props:{formInline:{id:(D=t==null?void 0:t.id)!=null?D:null,name:(P=t==null?void 0:t.name)!=null?P:"",storage:(x=t==null?void 0:t.storage)!=null?x:null,master:(R=t==null?void 0:t.master)!=null?R:!1,config:(q=t==null?void 0:t.config)!=null?q:{basePath:"",host:"",port:null,username:"",password:"",mode:"",endpoint:"",bucket:"",accessKey:"",accessSecret:"",domain:""},remark:(B=t==null?void 0:t.remark)!=null?B:""}},width:"40%",top:"5vh",draggable:!0,fullscreen:j(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>X(U,{ref:h}),open:_=>c(this,[_],function*({options:v}){if(e!=="新增"){const C=yield Q(t.id);C.code=="H200"&&(y.value=C.data),v.props.formInline.config=y.value.config}}),beforeSure:(v,{options:_})=>{const C=h.value.getRef(),b=_.props.formInline;function A(){E(`您${e}了配置名称为${b.name}的这条数据`,{type:"success"}),v(),r()}C.validate(N=>c(this,null,function*(){N&&(e==="新增"?(yield G(b)).code=="H200"&&A():(yield W(b)).code=="H200"&&A())}))}})}return K(()=>c(this,null,function*(){r()})),{form:o,loading:g,pagination:a,searchValue:n,dataList:u,onSearch:r,resetForm:V,openDialog:z,handleManageItem:d,handleDeleteItem:F,handleSetMaster:s,handleSizeChange:p,handleCurrentChange:M,handleSelectionChange:k}}export{se as useFileConfig};
