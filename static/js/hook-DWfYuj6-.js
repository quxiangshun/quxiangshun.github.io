var i=(t,o,s)=>new Promise((g,p)=>{var u=n=>{try{r(s.next(n))}catch(d){p(d)}},v=n=>{try{r(s.throw(n))}catch(d){p(d)}},r=n=>n.done?g(n.value):Promise.resolve(n.value).then(u,v);r((s=s.apply(t,o)).next())});import{aP as f,aX as m,P as M,n as c,q as U,$ as j,a2 as W,e as P,R,h as k,S as E,T as G,U as J}from"./index-vTRDVSJy.js";import{_ as K}from"./form.vue_vue_type_script_setup_true_lang-UdH5kD-Z.js";import{s as Q}from"./index-D8NgSwpL.js";import{s as Y}from"./list-CFwWPV2H.js";import"./hooks-gvBetFC1.js";const h="/dwOrder",Z=t=>f.request("post",m(`${h}/create`),{data:t}),w=t=>f.request("get",m(`${h}/list`),{params:t}),ee=t=>f.request("put",m(`${h}/update`),{data:t}),ae=t=>f.request("delete",m(`${h}/delete/${t}`));function ce(){const t=M({total:0,pageSize:10,currentPage:1,background:!0}),o=M({voltage:null,name:"",managerId:null,size:t.pageSize,current:t.currentPage}),s=c(),g=c([]),p=c(!1),u=c(!0),v=c(!1),r=c([]),n=c([]),d=[{label:"电压等级/kV",prop:"lineVoltage",width:120,fixed:"left"},{label:"线路名称",prop:"lineName",width:150,fixed:"left"},{label:"塔杆编号",prop:"poleNums",width:100},{label:"缺陷(隐患)状况",prop:"problem",width:150},{label:"巡线员昵称",prop:"xxyNickname",width:150},{label:"设备主人",prop:"managerNickname",width:150},{label:"处理意见",prop:"suggestions",width:150},{label:"备注（负责人填写）",prop:"remark",width:240},{label:"创建时间",prop:"createTime",minWidth:160,formatter:({createTime:a})=>j(a).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:150,slot:"operation"}];function C(a){Q("警告",{contentRenderer:()=>P("p",{style:"text-align: center;margin-bottom:20px"},[k("确认要删除"),P("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[a.title]),k("吗?")]),beforeSure:e=>i(this,null,function*(){(yield ae(a.id)).code=="H200"&&R(`已删除"${a.title}`,{type:"success"}),e(),l()})})}function H(a){t.currentPage=1,t.pageSize=a,l()}function I(a){t.currentPage=a,l()}function N(a){}function l(){return i(this,null,function*(){u.value=!0,o.current=t.currentPage,o.size=t.pageSize;const{code:a,data:e}=yield w(W(o));a!="H200"||(g.value=e.records,t.total=e.total,t.pageSize=e.size,t.currentPage=e.current),u.value=!1})}function X(){return i(this,null,function*(){const{data:a}=yield Y("deviceManager");r.value=a})}function q(){return i(this,null,function*(){const{data:a}=yield Y("XunXianYuan");n.value=a})}const L=a=>{a&&(a.resetFields(),l())};function V(a="新增",e){var b,S,x,$,z,D;E({title:`${a}线路`,props:{formInOrder:{id:(b=e==null?void 0:e.id)!=null?b:null,voltage:(S=e==null?void 0:e.voltage)!=null?S:null,name:(x=e==null?void 0:e.name)!=null?x:"",total:($=e==null?void 0:e.total)!=null?$:null,length:(z=e==null?void 0:e.length)!=null?z:null,managerId:(D=e==null?void 0:e.managerId)!=null?D:null,deviceManagers:r.value}},width:"40%",draggable:!0,fullscreen:J(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>G(K,{ref:s}),beforeSure:(F,{options:T})=>{const _=s.value.getRef(),y=T.props.formInOrder;function O(){R(`您${a}了线路名称为${y.name}的这条数据`,{type:"success"}),F(),l()}_.validate(A=>i(this,null,function*(){A&&(a==="新增"?(yield Z(y)).code=="H200"&&O():(yield ee(y)).code=="H200"&&O())}))}})}return U(()=>i(this,null,function*(){l(),X(),q()})),{deviceManagers:r,form:o,isShow:p,loading:u,columns:d,dataList:g,isLinkage:v,pagination:t,onSearch:l,resetForm:L,openDialog:V,handleDelete:C,handleSizeChange:H,handleCurrentChange:I,handleSelectionChange:N}}export{ce as useDwOrder};
