var g=(t,s,n)=>new Promise((m,d)=>{var c=r=>{try{u(n.next(r))}catch(p){d(p)}},b=r=>{try{u(n.throw(r))}catch(p){d(p)}},u=r=>r.done?m(r.value):Promise.resolve(r.value).then(c,b);u((n=n.apply(t,s)).next())});import{P as z,n as h,q as I,$ as Y,a2 as j,e as S,R as N,h as R,S as M,T as O,U as T,r as _,F as $,aY as k}from"./index-z501862F.js";import{_ as L}from"./form.vue_vue_type_script_setup_true_lang-CKngE-Z4.js";import{s as V}from"./index-C27yIgHt.js";import{g as q,d as w,a as A,u as B}from"./script-DqwFUle1.js";import"./index-ChDelqE2.js";import"./label-DjYKOmiC.js";import"./close-line-Dw4sg3MD.js";import"./mitt-E5P-NQ8u.js";import"./hooks-BuEsGYNv.js";function U(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!k(t)}function ae(){const t=z({total:0,pageSize:10,currentPage:1,background:!0}),s=z({name:"",size:t.pageSize,current:t.currentPage}),n=h(),m=h([]),d=h(!1),c=h(!0),b=[{label:"脚本名称",prop:"name",fixed:"left"},{label:"一级分裂",prop:"level1Name"},{label:"二级分裂",prop:"level2Name"},{label:"标签",prop:"labelNames",cellRenderer:({row:e})=>{const a=[],i=e.labelNames;for(let l=0;l<i.length;l++){const f=i[l];a.push(S(_("el-tag"),{size:"small",type:"primary",effect:"plain"},U(f)?f:{default:()=>[f]}))}return S($,null,[a])}},{label:"任务编号",prop:"taskId"},{label:"创建日期",prop:"createTIme",minWidth:110,width:120,showOverflowTooltip:!0,formatter:({createTime:e})=>Y(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:220,slot:"operation"}];function u(e){V("警告",{contentRenderer:()=>S("p",{style:"text-align: center;margin-bottom:20px"},[R("确认要删除"),S("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.username]),R("吗?")]),beforeSure:a=>g(this,null,function*(){(yield w(e.id)).code=="H200"&&N(`已删除"${e.userName}`,{type:"success"}),a(),o()})})}function r(e){t.currentPage=1,t.pageSize=e,o()}function p(e){t.currentPage=e,o()}function o(){return g(this,null,function*(){c.value=!0,s.current=t.currentPage,s.size=t.pageSize;const{code:e,data:a}=yield q(j(s));e=="H200"&&(m.value=a.records,t.total=a.total,t.pageSize=a.size,t.currentPage=a.current),c.value=!1})}const x=e=>{e&&(e.resetFields(),o())};function D(e="新增",a){var i,l;M({title:`${e}脚本`,props:{formInline:{id:(i=a==null?void 0:a.id)!=null?i:null,name:(l=a==null?void 0:a.name)!=null?l:""}},width:"40%",top:"5vh",draggable:!0,fullscreen:T(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>O(L,{ref:n}),beforeSure:(f,{options:P})=>{const H=n.value.getRef(),v=P.props.formInline;function y(){N(`您${e}了脚本数据`,{type:"success"}),f(),o()}H.validate(C=>g(this,null,function*(){C&&(e==="新增"?(yield A(v)).code=="H200"&&y():(yield B(v)).code=="H200"&&y())}))}})}return I(()=>{o()}),{form:s,isShow:d,loading:c,columns:b,dataList:m,pagination:t,onSearch:o,resetForm:x,openDialog:D,handleDelete:u,handleSizeChange:r,handleCurrentChange:p}}export{ae as useScriptList};
