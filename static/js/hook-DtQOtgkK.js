var c=(h,g,s)=>new Promise((r,n)=>{var o=t=>{try{f(s.next(t))}catch(u){n(u)}},y=t=>{try{f(s.throw(t))}catch(u){n(u)}},f=t=>t.done?r(t.value):Promise.resolve(t.value).then(o,y);f((s=s.apply(h,g)).next())});import{_}from"./form.vue_vue_type_script_setup_true_lang-Dh59Y89h.js";import{n as l,P,q as A,bk as B,a2 as E,bl as T,R as v,e as V,bm as q,h as F,S as L,T as O,U,bn as j,bo as G,bp as J}from"./index-z501862F.js";import{s as Q}from"./index-C27yIgHt.js";import"./hooks-BuEsGYNv.js";function ee(){const h=l(""),g=l(),s=l([]),r=l(!0),n=P({total:0,pageSize:12,currentPage:1,background:!0}),o=P({configName:"",size:n.pageSize,current:n.currentPage});function y(e){Q("警告",{contentRenderer:()=>V("p",{style:"text-align: center;margin-bottom:20px"},[F("确认要将该配置："),V("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.configName]),F("删除吗?")]),beforeSure:a=>c(this,null,function*(){(yield q(e.id)).code=="H200"&&v(`已将"${e.configName}删除`,{type:"success"}),a(),i()})})}function f(e){return c(this,null,function*(){b("修改",e)})}function t(e){n.currentPage=1,n.pageSize=e,i()}function u(e){n.currentPage=e,i()}function H(e){}function i(){return c(this,null,function*(){r.value=!0,o.current=n.currentPage,o.size=n.pageSize;const{data:e,code:a}=yield B(E(o));a=="H200"&&(s.value=e.records,n.total=e.total,n.pageSize=e.size,n.currentPage=e.current),r.value=!1})}const k=e=>{e&&(e.resetFields(),i())};function b(e="新增",a){var S,z,N,R,D;let d=l({});L({title:`${e}配置`,props:{formInline:{id:(S=a==null?void 0:a.id)!=null?S:null,configName:(z=a==null?void 0:a.configName)!=null?z:"",configKey:(N=a==null?void 0:a.configKey)!=null?N:"",configValue:(R=a==null?void 0:a.configValue)!=null?R:"",remark:(D=a==null?void 0:a.remark)!=null?D:""}},width:"45%",top:"5vh",draggable:!0,fullscreen:U(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>O(_,{ref:g}),open:K=>c(this,[K],function*({options:m}){if(e!=="新增"){const p=yield J(a.id);p.code=="H200"&&(d.value=p.data),m.props.formInline.configKey=d.value.configKey,m.props.formInline.configValue=d.value.configValue}}),beforeSure:(m,{options:K})=>{const p=g.value.getRef(),C=K.props.formInline;function I(){v(`您${e}了配置名称为${C.configName}的这条数据`,{type:"success"}),m(),i()}p.validate($=>c(this,null,function*(){$&&(e==="新增"?(yield j(C)).code=="H200"&&I():(yield G(C)).code=="H200"&&I())}))}})}function x(){return c(this,null,function*(){(yield T()).code=="H200"&&v("缓存刷新成功",{type:"success"})})}return A(()=>c(this,null,function*(){i()})),{form:o,loading:r,pagination:n,searchValue:h,dataList:s,onSearch:i,resetForm:k,openDialog:b,handleManageItem:f,handleDeleteItem:y,handleSizeChange:t,handleCurrentChange:u,handleSelectionChange:H,handleRefreshCache:x}}export{ee as useConfig};
