var C=(v,w,o)=>new Promise((d,r)=>{var b=s=>{try{m(o.next(s))}catch(e){r(e)}},g=s=>{try{m(o.throw(s))}catch(e){r(e)}},m=s=>s.done?d(s.value):Promise.resolve(s.value).then(b,g);m((o=o.apply(v,w)).next())});import{d as F,n as R,P as V,q as U,ai as L,r as u,c as x,o as y,e as t,j as a,g as p,F as N,t as O,i as T,f as P,h as D,G as H,R as S}from"./index-_ppfBu12.js";import{X}from"./index-BmHWNIkY.js";import{d as j}from"./upload-2-line-CWGyx_9V.js";import{R as _}from"./index-C07DLrIx.js";import{a as q,u as E,f as G}from"./audio-C1ZfDVQ_.js";import{e as A}from"./mitt-E5P-NQ8u.js";const M={class:"el-upload__text"},$=P("div",{class:"el-upload__tip text-red"}," 限制1个文件，新的文件会覆盖旧文件 ",-1),ee=F({__name:"form",props:{formAttrProp:{default:()=>({item:{},nameLabel:"",depts:[],tasks:[],categoryOptions:[]})}},setup(v){const o=R(v.formAttrProp),d=V({files:[]}),r=R(0),b=e=>{},g=()=>{},m=(e,l)=>{d.files=[e],H(()=>{s()})};function s(){const e=r.value;e==0||e==2?o.value.item.name=d.files[0].name:e==1&&(o.value.item.name="")}return U(()=>{A.on("submitResource",e=>C(this,null,function*(){const l=new FormData;l.append("level1CategoryId",e.level1CategoryId),l.append("level2CategoryId",e.level2CategoryId),l.append("taskId",e.taskId),l.append("labelIds",e.labelIds),l.append("userIds",e.userIds),l.append("name",e.name),l.append("file",d.files[0].raw);function f(){S(`您${c}了脚本数据`,{type:"success"})}const c=e.value.name;c!=="新增"?(yield q(l)).code=="H200"&&f():(yield E(null)).code=="H200"&&f()}))}),L(()=>{A.off("submitResource")}),(e,l)=>{const f=u("IconifyIconOffline"),c=u("el-upload"),i=u("el-form-item"),I=u("el-row"),h=u("el-radio-button"),B=u("el-radio-group"),k=u("el-input");return y(),x("div",null,[t(X,{formAttrProp:o.value,onSubmit:b,onReset:g},{"top-attr":a(()=>[t(I,null,{default:a(()=>[t(p(_),null,{default:a(()=>[t(i,{label:"附件："},{default:a(()=>[t(c,{ref:"uploadRef","file-list":d.files,"onUpdate:fileList":l[0]||(l[0]=n=>d.files=n),drag:"",action:"#",class:"!w-full","auto-upload":!1,limit:1,"on-change":m},{tip:a(()=>[$]),default:a(()=>[P("div",M,[t(f,{icon:p(j),width:"26",class:"m-auto mb-2"},null,8,["icon"]),D(" 可点击或拖拽上传 ")])]),_:1},8,["file-list"])]),_:1})]),_:1})]),_:1})]),"middle-attr":a(()=>[t(I,null,{default:a(()=>[t(p(_),null,{default:a(()=>[t(i,{label:"音频名称："},{default:a(()=>[t(B,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=n=>r.value=n),onChange:s},{default:a(()=>[(y(!0),x(N,null,O(p(G),n=>(y(),T(h,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(p(_),null,{default:a(()=>[t(i,null,{default:a(()=>[t(k,{modelValue:o.value.item.name,"onUpdate:modelValue":l[2]||(l[2]=n=>o.value.item.name=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(p(_),null,{default:a(()=>[t(i,{label:"音频说明："},{default:a(()=>[t(k,{modelValue:o.value.item.remark,"onUpdate:modelValue":l[3]||(l[3]=n=>o.value.item.remark=n),rows:3,type:"textarea",placeholder:"Please input"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["formAttrProp"])])}}});export{ee as _};
