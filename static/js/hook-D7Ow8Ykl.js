var r=(l,g,i)=>new Promise((u,d)=>{var m=a=>{try{f(i.next(a))}catch(o){d(o)}},y=a=>{try{f(i.throw(a))}catch(o){d(o)}},f=a=>a.done?u(a.value):Promise.resolve(a.value).then(m,y);f((i=i.apply(l,g)).next())});import{_ as k}from"./form.vue_vue_type_script_setup_true_lang-Cy3YHv7n.js";import{P as A,n as C,q as M,e as c,M as N,bh as z,R as p,h as $,S as E,T as x,U as q,I as P,F as U,r as Y,aY as G}from"./index-_ppfBu12.js";import{u as J}from"./hooks-B99vGHGm.js";import{l as K,d as Q,a as W,u as X}from"./video-collection-hRml2WT1.js";import{s as Z}from"./index-CIrz3C_X.js";import{t as L,c as w}from"./category-B2RJSKvQ.js";import"./index-C07DLrIx.js";import"./rule-TEPPSPkk.js";import"./index-D86wgk4F.js";function ee(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!G(l)}function de(){const l=A({title:""}),g=C(),i=C([]),u=C(!0),d=(e,t=!1)=>e==0?t?"显示":"success":t?"隐藏":"danger",m=[{label:"视频合集名称",prop:"title",align:"left",cellRenderer:({row:e})=>c(U,null,[c("span",{class:"inline-block mr-1"},[x(J(e.icon),{style:{paddingTop:"1px"}})]),c("span",null,[e.title])])},{label:"排序",prop:"sortOrder",width:100},{label:"显示状态",prop:"visible",cellRenderer:({row:e,props:t})=>{let n;return c(Y("el-tag"),{size:t.size,type:d(e.visible),effect:"plain"},ee(n=d(e.visible,!0))?n:{default:()=>[n]})},width:100},{label:"操作",fixed:"right",width:210,slot:"operation"}];function y(e){}function f(e){e&&(e.resetFields(),a())}function a(){return r(this,null,function*(){u.value=!0;const{code:e,data:t}=yield K();let n=t;e!="H200"||(N(l.title)||(n=n.filter(h=>h.title.includes(l.title))),i.value=z(n)),u.value=!1})}function o(e){if(!e||!e.length)return;const t=[];for(let n=0;n<e.length;n++)e[n].title=e[n].title,o(e[n].children),t.push(e[n]);return t}function D(e="新增",t){return r(this,null,function*(){var v,V,F,R,O,I;const{data:n}=yield L(0),{data:h}=yield w();E({title:`${e}视频合集`,props:{formInline:{id:(v=t==null?void 0:t.id)!=null?v:null,types:h,type:(V=t==null?void 0:t.type)!=null?V:0,higherVideoCollectionOptions:o(P(n)),categoryId:(F=t==null?void 0:t.categoryId)!=null?F:0,title:(R=t==null?void 0:t.title)!=null?R:"",sortOrder:(O=t==null?void 0:t.sortOrder)!=null?O:1,visible:(I=t==null?void 0:t.visible)!=null?I:0}},width:"55%",top:"2%",draggable:!0,fullscreen:q(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>x(k,{ref:g}),beforeSure:(ge,me)=>r(this,[ge,me],function*(H,{options:_}){const j=g.value.getRef(),b=_.props.formInline;function S(){p(`${e}视频合集：${b.title}成功`,{type:"success"}),H(),a()}j.validate(B=>r(this,null,function*(){if(B)try{if(e==="新增"){const s=yield W(b);s.code=="H200"?S():p(`${s.message}`,{type:"error"})}else{const s=yield X(b);s.code=="H200"?S():p(`${s.message}`,{type:"error"})}}catch(s){console.error("Error update menu:",s),p(`${e}视频合集时出错`,{type:"error"})}}))})})})}function T(e){Z("警告",{contentRenderer:()=>c("p",{style:"text-align: center;margin-bottom:20px"},[$("确认要删除"),c("strong",{style:"color:var(--el-color-danger);margin:0 5px"},[e.title]),$("吗？此视频合集的子视频合集也会被删除")]),beforeSure:t=>r(this,null,function*(){(yield Q(e.id)).code=="H200"&&p(`已删除"${e.title}`,{type:"success"}),t(),a()})})}return M(()=>{a()}),{form:l,loading:u,columns:m,dataList:i,onSearch:a,resetForm:f,openDialog:D,handleDelete:T,handleSelectionChange:y}}export{de as useVideoCollection};
